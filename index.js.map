{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function getImagesByQuery(searchQuery, page, perPage) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const API_KEY = '51363368-0cc0b280f35048ea67ead6bf3';\n\n  const params = {\n    key: API_KEY,\n    q: searchQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: perPage,\n  };\n\n  const resData = await axios.get(BASE_URL, { params });\n\n  return resData.data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { refs } from '../main';\n\nimport { page } from '../main';\n\nlet gallery;\n\nexport function createLightbox() {\n  if (!gallery) {\n    gallery = new SimpleLightbox('.gallery a');\n  }\n  gallery.refresh();\n}\n\nexport function createGallery(arrayImages, page) {\n  const markup = arrayImages\n    .map(\n      item =>\n        `<li class=\"img-box\">\n          <a href=\"${item.largeImageURL}\">\n            <img \n              src=\"${item.webformatURL}\" \n              alt=\"${item.tags}\" \n              width=\"360\" \n              height=\"200\"\n            >\n            <ul class=\"subscriptions\">\n                <li class=\"sub-title\">\n                  <h6>Likes</h6>\n                  <p>${item.likes}</p>\n                </li>\n                <li class=\"sub-title\">\n                  <h6>Views</h6>\n                  <p>${item.views}</p>\n                </li>\n                <li class=\"sub-title\">\n                  <h6>Comments</h6>\n                  <p>${item.comments}</p>\n                </li>\n                <li class=\"sub-title\">\n                  <h6>Downloads</h6>\n                  <p>${item.downloads}</p>\n                </li>\n            </ul>\n          </a>\n        </li>`\n    )\n    .join('');\n  console.log(markup);\n  // refs.galleryList.insertAdjacentHTML('beforeend', markup);\n\n  //   refs.galleryList.innerHTML = markup;\n\n  //   if (page > 1) {\n  //     refs.galleryList.insertAdjacentHTML('beforeend', markup);\n  //     return;\n  //   } else {\n  //     refs.galleryList.innerHTML = markup;\n  //     return;\n  //   }\n\n  if (page === 1) {\n    refs.galleryList.innerHTML = markup;\n  } else {\n    refs.galleryList.insertAdjacentHTML('beforeend', markup);\n  }\n}\n\nexport function hideLoader() {\n  refs.loader.classList.add('is-hidden');\n}\nexport function showLoader() {\n  refs.loader.classList.remove('is-hidden');\n}\nexport function clearMarkUp() {\n  refs.galleryList.innerHTML = '';\n}\n\nexport function showLoadMoreButton() {\n  refs.loadMoreBtn.classList.remove('is-hidden');\n}\n\nexport function hideLoadMoreButton() {\n  refs.loadMoreBtn.classList.add('is-hidden');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { getImagesByQuery } from './js/pixabay-api.js';\n\nimport {\n  createGallery,\n  showLoader,\n  hideLoader,\n  clearMarkUp,\n  createLightbox,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n} from './js/render-functions.js';\n\nexport const refs = {\n  form: document.querySelector('.form'),\n  galleryList: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  input: document.querySelector('input'),\n  loadMoreBtn: document.querySelector('.load-more-btn'),\n};\n\nexport let page = 1;\nexport let searchQuery = '';\nexport const perPage = 15;\n\n// !submit\nasync function onSubmit(event) {\n  event.preventDefault();\n  page = 1;\n  clearMarkUp();\n  showLoader();\n\n  hideLoadMoreButton();\n\n  searchQuery = event.target.elements['search-text'].value.trim();\n\n  if (!searchQuery) {\n    hideLoader();\n    refs.form.reset();\n    return iziToast.error({\n      title: 'Помилка!',\n      message: 'Введіть ключеве слово пошуку!',\n      position: 'center',\n    });\n  }\n\n  try {\n    const getResponse = await getImagesByQuery(searchQuery, page, perPage);\n\n    if (getResponse.hits.length === 0) {\n      iziToast.error({\n        title: 'Помилка!',\n        message: 'Зображення не знайдено',\n        position: 'center',\n      });\n      return;\n    }\n    //   !!!!!!!!!!!!!!!!1\n    createGallery(getResponse.hits, page);\n    createLightbox();\n    // !!!!!!!!!!!!!!!!!!11\n    iziToast.info({\n      title: 'Результат пошуку:',\n      message: `знайдено ${getResponse.totalHits} фотографій!`,\n      position: 'center',\n    });\n\n    if (getResponse.totalHits > perPage) {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    console.log(error);\n    iziToast.error({\n      title: 'Помилка!',\n      message: 'Не вдалося завантажити зображення',\n      position: 'center',\n    });\n  } finally {\n    hideLoader();\n  }\n}\n\n// ! прокрутка\nfunction smoothScroll() {\n  const galleryItem = document.querySelector('.img-box');\n\n  if (galleryItem) {\n    const cardHeight = galleryItem.getBoundingClientRect().height;\n\n    const gap =\n      parseInt(window.getComputedStyle(galleryItem.parentElement).gap) || 0;\n\n    const scrollHeight = cardHeight * 2 + gap;\n\n    window.scrollBy({\n      top: scrollHeight,\n      behavior: 'smooth',\n    });\n  }\n}\n\nasync function onClick(event) {\n  event.preventDefault();\n  page++; // Інкрементуємо сторінку перед запитом\n\n  showLoader();\n  hideLoadMoreButton();\n\n  try {\n    const getResponse = await getImagesByQuery(searchQuery, page, perPage);\n\n    // Якщо зображень немає\n    if (getResponse.hits.length === 0) {\n      iziToast.info({\n        title: 'Увага',\n        message: 'Більше зображень немає',\n        position: 'center',\n      });\n      hideLoadMoreButton();\n      return;\n    }\n\n    // Додаємо тільки нові зображення\n    createGallery(getResponse.hits, page);\n    createLightbox(); // Оновлюємо lightbox\n\n    // Перевірка останньої сторінки\n    const lastPage = Math.ceil(getResponse.totalHits / perPage);\n    if (page >= lastPage) {\n      refs.loadMoreBtn.classList.add('is-hidden');\n      iziToast.info({\n        title: 'Увага',\n        message: 'Це останні зображення',\n        position: 'center',\n      });\n    } else {\n      showLoadMoreButton();\n    }\n\n    // Плавна прокрутка\n    smoothScroll();\n  } catch (error) {\n    console.error('Помилка завантаження:', error);\n    iziToast.error({\n      title: 'Помилка!',\n      message: 'Не вдалося завантажити зображення',\n      position: 'center',\n    });\n  } finally {\n    hideLoader();\n  }\n}\n\n// async function onClick(event) {\n//   event.preventDefault();\n//   const currentScrollPosition = window.scrollY;\n//   //   refs.galleryList.classList.add('is-hidden');\n//   //   refs.loadMoreBtn.classList.add('is-hidden');\n//   page++;\n\n//   showLoader();\n//   refs.loadMoreBtn.classList.add('is-hidden');\n\n//   try {\n//     const getResponse = await getImagesByQuery(searchQuery, page, perPage);\n\n//     if (getResponse.hits.length === 0) {\n//       iziToast.info({\n//         title: 'Увага',\n//         message: 'Більше зображень немає',\n//         position: 'center',\n//       });\n//       return;\n//     }\n//     // !!!!!!!!!!!!!1\n//     createGallery(getResponse.hits, page);\n//     // !!!!!!!!!!!!!!!!!!1\n//     window.requestAnimationFrame(() => {\n//       window.scrollTo({\n//         top: currentScrollPosition,\n//         behavior: 'instant',\n//       });\n\n//       smoothScroll();\n//     });\n\n//     const lastPage = Math.ceil(getResponse.totalHits / perPage);\n\n//     refs.loadMoreBtn.classList.remove('is-hidden');\n\n//     if (lastPage === page) {\n//       refs.loadMoreBtn.classList.add('is-hidden');\n//       refs.loadMoreBtn.removeEventListener('click', onClick);\n\n//       iziToast.info({\n//         title: 'Увага',\n//         message: 'Остання сторінка!',\n//         position: 'center',\n//       });\n//     }\n//   } catch (error) {\n//     console.log(error);\n//     iziToast.error({\n//       title: 'Помилка!',\n//       message: 'Не вдалося завантажити більше зображень',\n//       position: 'center',\n//     });\n//   } finally {\n//     hideLoader();\n//     refs.galleryList.classList.remove('is-hidden');\n//   }\n// }\n\nrefs.form.addEventListener('submit', onSubmit);\nrefs.loadMoreBtn.addEventListener('click', onClick);\n"],"names":["getImagesByQuery","searchQuery","page","perPage","BASE_URL","params","axios","gallery","createLightbox","SimpleLightbox","createGallery","arrayImages","markup","item","refs","hideLoader","showLoader","clearMarkUp","showLoadMoreButton","hideLoadMoreButton","onSubmit","event","iziToast","getResponse","error","smoothScroll","galleryItem","cardHeight","gap","scrollHeight","onClick","lastPage"],"mappings":"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"}